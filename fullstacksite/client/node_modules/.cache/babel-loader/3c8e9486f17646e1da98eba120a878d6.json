{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Graciela Putri\\\\Documents\\\\UoB\\\\WebTech\\\\fullstacksite\\\\client\\\\src\\\\views\\\\ShoppingCartPage.js\";\nimport React, { Component } from 'react';\nimport OverHeadBar from \"./OverHeadBar\";\nimport IconBar from \"./IconBar\";\nimport CartProduct from \"../Component/CartProduct\";\nimport cart from \"../views/ShoppingCart.module.css\";\nimport CheckoutForm from \"../Component/CheckoutForm\";\nimport headBar from \"./OverHeadBar.module.css\";\n\nclass ShoppingCartPage extends Component {\n  constructor(props) {\n    super(props);\n\n    this.removeItem = index => {\n      let arr = JSON.parse(localStorage.getItem('myCart'));\n      arr.splice(index, 1);\n      localStorage.setItem('myCart', JSON.stringify(arr));\n      this.setState({\n        productList: arr\n      });\n      var money = this.totalCost();\n      this.setState({\n        totalCost: money\n      });\n    };\n\n    this.emptyCart = () => {\n      localStorage.clear();\n      this.setState({\n        productList: null,\n        totalCost: 0\n      });\n    };\n\n    this.checkoutCart = childState => {\n      console.log(childState);\n      var list = this.state.productList;\n      console.log(list);\n      fetch('/api/orders/createNewOrder', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          firstName: childState.formCompulsory.firstName,\n          lastName: childState.formCompulsory.lastName,\n          email: childState.formCompulsory.email,\n          address1: childState.formCompulsory.address1,\n          city: childState.formCompulsory.city,\n          country: childState.formCompulsory.country,\n          postcode: childState.formCompulsory.postcode,\n          address2: childState.formOptional.address2,\n          address3: childState.formOptional.address3,\n          phone: childState.formOptional.phone,\n          products: this.state.productList\n        })\n      }).then(res => {\n        console.log(res);\n      }).catch(err => console.log(err));\n      alert(\"Success\"); //console.log(\"passed to shoppingCartPage\");\n      //console.log(this.state);\n    };\n\n    this.state = {\n      loading: true,\n      totalCost: 0,\n      productList: null\n    };\n    this.checkoutCart = this.checkoutCart.bind(this);\n  }\n\n  async componentDidMount() {\n    let cart = await localStorage.getItem('myCart');\n    var arr = JSON.parse(cart);\n\n    if (arr) {\n      this.setState({\n        productList: arr\n      });\n    }\n\n    var money = this.totalCost();\n    this.setState({\n      totalCost: money\n    });\n    console.log(this.state);\n    this.setState({\n      loading: false\n    });\n  }\n\n  totalCost() {\n    var list = this.state.productList;\n    var sum = 0;\n\n    for (var key in list) {\n      sum += list[key].cost;\n    }\n\n    return sum.toFixed(2);\n  }\n\n  render() {\n    if (this.state.loading) return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 40\n      }\n    }, /*#__PURE__*/React.createElement(OverHeadBar, {\n      currentPage: \"cart\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 45\n      }\n    }), \"loading...\");\n\n    if (!this.state.productList || this.state.productList.length === 0) {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(OverHeadBar, {\n        currentPage: \"cart\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 21\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: cart.empty,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 21\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 21\n        }\n      }, \"Empty cart\"), /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 21\n        }\n      }, \"Go shopping\"), /*#__PURE__*/React.createElement(IconBar, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 21\n        }\n      }));\n    }\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: headBar.overview,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(OverHeadBar, {\n      currentPage: \"cart\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: cart.overview,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: cart.productList,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 21\n      }\n    }, this.state.productList.map((product, index) => {\n      return /*#__PURE__*/React.createElement(CartProduct, {\n        product: product,\n        index: index,\n        key: index,\n        onRemove: this.removeItem,\n        updateCart: () => this.componentDidMount(),\n        zeroCount: () => this.removeItem(index),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 33\n        }\n      });\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: cart.right,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(CheckoutForm, {\n      onClear: this.emptyCart,\n      onCheckout: this.checkoutCart,\n      money: this.totalCost(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 25\n      }\n    }))), /*#__PURE__*/React.createElement(IconBar, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 17\n      }\n    }));\n  }\n\n}\n\nexport default ShoppingCartPage;","map":{"version":3,"sources":["C:/Users/Graciela Putri/Documents/UoB/WebTech/fullstacksite/client/src/views/ShoppingCartPage.js"],"names":["React","Component","OverHeadBar","IconBar","CartProduct","cart","CheckoutForm","headBar","ShoppingCartPage","constructor","props","removeItem","index","arr","JSON","parse","localStorage","getItem","splice","setItem","stringify","setState","productList","money","totalCost","emptyCart","clear","checkoutCart","childState","console","log","list","state","fetch","method","headers","body","firstName","formCompulsory","lastName","email","address1","city","country","postcode","address2","formOptional","address3","phone","products","then","res","catch","err","alert","loading","bind","componentDidMount","sum","key","cost","toFixed","render","length","empty","overview","map","product","right"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\r\nimport OverHeadBar from \"./OverHeadBar\";\r\nimport IconBar from \"./IconBar\";\r\nimport CartProduct from \"../Component/CartProduct\";\r\nimport cart from \"../views/ShoppingCart.module.css\";\r\nimport CheckoutForm from \"../Component/CheckoutForm\";\r\nimport headBar from \"./OverHeadBar.module.css\";\r\n\r\nclass ShoppingCartPage extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            loading: true,\r\n            totalCost: 0,\r\n            productList: null\r\n        }\r\n        this.checkoutCart = this.checkoutCart.bind(this);\r\n    }\r\n\r\n    async componentDidMount() {\r\n        let cart = await localStorage.getItem('myCart');\r\n        var arr = JSON.parse(cart);\r\n        if (arr) {\r\n            this.setState({productList: arr});\r\n        }\r\n        var money = this.totalCost();\r\n        this.setState({totalCost: money});\r\n        console.log(this.state);\r\n        this.setState({loading: false});\r\n    }\r\n\r\n    removeItem = (index) => {\r\n        let arr = JSON.parse(localStorage.getItem('myCart'));\r\n        arr.splice(index,1);\r\n        localStorage.setItem('myCart', JSON.stringify(arr));\r\n        this.setState({productList: arr});\r\n        var money = this.totalCost();\r\n        this.setState({totalCost: money});\r\n    }\r\n\r\n    emptyCart = () => {\r\n        localStorage.clear();\r\n        this.setState({productList: null, totalCost: 0});\r\n    }\r\n\r\n    checkoutCart = (childState) => {\r\n        console.log(childState);\r\n        var list = this.state.productList;\r\n        console.log(list);\r\n        fetch(('/api/orders/createNewOrder'), {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            },\r\n            body: JSON.stringify({\r\n                firstName: childState.formCompulsory.firstName,\r\n                lastName: childState.formCompulsory.lastName,\r\n                email: childState.formCompulsory.email,\r\n                address1: childState.formCompulsory.address1,\r\n                city: childState.formCompulsory.city,\r\n                country: childState.formCompulsory.country,\r\n                postcode: childState.formCompulsory.postcode,\r\n                address2: childState.formOptional.address2,\r\n                address3: childState.formOptional.address3,\r\n                phone: childState.formOptional.phone,\r\n                products: this.state.productList\r\n            })\r\n        }).then((res) => {\r\n            console.log(res)\r\n        }).catch(err => console.log(err));\r\n        alert(\"Success\");\r\n        //console.log(\"passed to shoppingCartPage\");\r\n        //console.log(this.state);\r\n    }\r\n\r\n    totalCost() {\r\n        var list = this.state.productList;\r\n        var sum = 0;\r\n        for (var key in list) {\r\n            sum += list[key].cost;\r\n        }\r\n        return sum.toFixed(2);\r\n    }\r\n\r\n    render() {\r\n        if (this.state.loading) return <div><OverHeadBar currentPage='cart'/>loading...</div>\r\n        if (!this.state.productList || this.state.productList.length===0) {\r\n            return (\r\n                <div>\r\n                    <OverHeadBar currentPage='cart'/>\r\n                    <div className={cart.empty}>\r\n                        \r\n                    </div>\r\n                    <div>Empty cart</div>\r\n                    <div>Go shopping</div>\r\n                    <IconBar />\r\n                </div>);}\r\n        return (\r\n            <div className={headBar.overview}>\r\n                <OverHeadBar currentPage='cart'/>\r\n                <div className={cart.overview}>\r\n                    <div className={cart.productList}>\r\n                        {this.state.productList.map((product, index) => {\r\n                            return (\r\n                                <CartProduct product={product} index={index} key={index} onRemove={this.removeItem}\r\n                                updateCart={()=>this.componentDidMount()} zeroCount={()=>this.removeItem(index)}/>\r\n                            )})\r\n                        }\r\n                    </div>\r\n                    <div className={cart.right}>\r\n                        <CheckoutForm onClear={this.emptyCart} onCheckout={this.checkoutCart} money={this.totalCost()}/>\r\n                    </div>\r\n                </div>\r\n\r\n                <IconBar />\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default ShoppingCartPage;"]},"metadata":{},"sourceType":"module"}